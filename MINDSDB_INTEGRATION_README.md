# MindsDB Integration for Coastal Data Analysis

This integration connects all datasets in the webtool folder to MindsDB for AI-powered coastal data analysis and predictions.

## üåä Datasets Integrated

### 1. Satellite Sea Level Data
- **Location**: `jiayou_sat_data/monthly_raw/`
- **Format**: NetCDF (.nc) files
- **Coverage**: Global monthly sea level anomaly data (2010-2023)
- **Variables**: Sea Level Anomaly (SLA), latitude, longitude, timestamp
- **Files**: 365+ monthly satellite altimetry files

### 2. Tide Prediction Data
- **Location**: `HighTide/`
- **Format**: Text files (NOAA format)
- **Stations**: 
  - Port Jefferson (`portJeff.txt`)
  - Miami (`miami.txt`)
  - NYC Battery Park (`nycBatteryPark.txt`)
- **Variables**: Date, time, prediction, tide type (High/Low), station

### 3. Processed Satellite Data
- **Location**: Generated by `sa_data.py`
- **Format**: CSV files
- **Coverage**: Station-specific processed satellite data
- **Variables**: Date, sea level anomaly, station ID

## üöÄ Quick Start

### Prerequisites

1. **Python Environment**: Ensure you're using the `ams585venv` virtual environment
2. **MindsDB**: The script will automatically install MindsDB if not present
3. **Dependencies**: Install required packages

```bash
# Activate virtual environment
source ams585venv/bin/activate

# Install dependencies
pip install -r requirements_mindsdb.txt
```

### Running the Integration

```bash
# Navigate to webtool directory
cd webtool

# Run the MindsDB integration
python mindsdb_integration.py
```

## ü§ñ AI Models Created

### 1. Sea Level Predictor
- **Purpose**: Predict future sea level anomalies
- **Input**: Historical satellite data with temporal and spatial features
- **Output**: Predicted sea level anomaly values
- **Time Series**: 12-month prediction window

### 2. Tide Predictor
- **Purpose**: Predict tide levels for specific stations
- **Input**: Historical tide data with temporal features
- **Output**: Predicted tide levels (high/low)
- **Time Series**: 24-hour prediction window

### 3. Coastal Analysis Predictor
- **Purpose**: Combined analysis of sea level and tide data
- **Input**: Integrated satellite and tide data
- **Output**: Comprehensive coastal predictions
- **Features**: Spatial correlation between satellite and tide data

## üìä Data Processing Pipeline

### Step 1: Data Loading
```python
# Load satellite data (NetCDF files)
coastal_mindsdb.load_satellite_data(limit_files=5)

# Load tide prediction data
coastal_mindsdb.load_tide_data()

# Load processed satellite data
coastal_mindsdb.load_processed_satellite_data()
```

### Step 2: AI Model Creation
```python
# Create prediction models
coastal_mindsdb.create_ai_models()
```

### Step 3: Predictions
```python
# Run predictions
coastal_mindsdb.run_predictions()
```

### Step 4: Insights Generation
```python
# Generate analytical insights
coastal_mindsdb.generate_insights()
```

### Step 5: Results Export
```python
# Export results to files
coastal_mindsdb.export_results()
```

## üîç Data Analysis Features

### Sea Level Analysis
- **Trend Analysis**: Long-term sea level change detection
- **Seasonal Patterns**: Monthly and yearly variations
- **Spatial Distribution**: Geographic patterns in sea level anomalies
- **Anomaly Detection**: Identification of unusual sea level events

### Tide Analysis
- **Station Comparison**: Compare tide patterns across locations
- **Temporal Patterns**: Daily, monthly, and seasonal tide variations
- **High/Low Tide Analysis**: Separate analysis of high and low tides
- **Prediction Accuracy**: Model performance evaluation

### Combined Analysis
- **Correlation Analysis**: Relationship between satellite and tide data
- **Coastal Impact Assessment**: Integrated coastal change analysis
- **Risk Assessment**: Flood risk and coastal vulnerability
- **Climate Impact**: Long-term climate change effects

## üìà Example Queries

### Sea Level Predictions
```sql
-- Predict sea level for next month
SELECT * FROM mindsdb.sea_level_predictor 
WHERE timestamp > '2024-01-01'
LIMIT 10;
```

### Tide Predictions
```sql
-- Predict tides for specific station
SELECT * FROM mindsdb.tide_predictor 
WHERE station = 'portjefferson' AND date > '2024-01-01';
```

### Trend Analysis
```sql
-- Analyze sea level trends by year
SELECT 
    year, 
    AVG(sea_level_anomaly) as avg_sea_level,
    COUNT(*) as data_points
FROM satellite_sea_level
WHERE sea_level_anomaly IS NOT NULL
GROUP BY year
ORDER BY year;
```

### Seasonal Analysis
```sql
-- Monthly patterns
SELECT 
    month,
    AVG(sea_level_anomaly) as avg_sea_level,
    AVG(prediction) as avg_tide
FROM satellite_sea_level s
LEFT JOIN tide_predictions t ON s.date = t.date
WHERE s.sea_level_anomaly IS NOT NULL
GROUP BY month
ORDER BY month;
```

## üìÅ Output Files

The integration generates several output files in the `mindsdb_results/` directory:

### 1. Predictions
- `sea_level_predictions.csv`: Future sea level predictions
- `tide_predictions.csv`: Tide level predictions
- `coastal_analysis_predictions.csv`: Combined coastal predictions

### 2. Insights
- `insights_summary.json`: Summary of analysis results
- `trend_analysis.csv`: Long-term trend analysis
- `seasonal_patterns.csv`: Seasonal variation analysis

### 3. Model Performance
- `model_accuracy.csv`: Model performance metrics
- `prediction_errors.csv`: Prediction error analysis

## üîß Configuration Options

### MindsDB Connection
```python
# Custom MindsDB connection
coastal_mindsdb = CoastalDataMindsDB(
    mindsdb_host='localhost',
    mindsdb_port=47334
)
```

### Data Processing Limits
```python
# Limit satellite files for testing
coastal_mindsdb.load_satellite_data(limit_files=5)

# Process specific stations
coastal_mindsdb.load_processed_satellite_data(station_ids=[1, 2, 3])
```

### Model Training Options
```python
# Custom model parameters
training_options = {
    'timeseries_settings': {
        'is_timeseries': True,
        'order_by': 'timestamp',
        'window': 12  # 12 months for sea level
    }
}
```

## üõ†Ô∏è Troubleshooting

### Common Issues

1. **MindsDB Connection Failed**
   ```bash
   # Start MindsDB server
   mindsdb start
   ```

2. **Missing Dependencies**
   ```bash
   # Install all requirements
   pip install -r requirements_mindsdb.txt
   ```

3. **Large File Processing**
   ```python
   # Reduce file limit for testing
   coastal_mindsdb.load_satellite_data(limit_files=2)
   ```

4. **Memory Issues**
   ```python
   # Process smaller batches
   coastal_mindsdb.load_satellite_data(limit_files=1)
   ```

### Performance Optimization

1. **Batch Processing**: Process data in smaller batches
2. **File Limits**: Use `limit_files` parameter for testing
3. **Memory Management**: Close NetCDF files after processing
4. **Parallel Processing**: Use multiprocessing for large datasets

## üìö Advanced Usage

### Custom Data Sources
```python
# Add custom data source
def load_custom_data(self, data_path):
    # Custom data loading logic
    pass
```

### Custom Models
```python
# Create custom prediction model
custom_model = Predictor(
    name='custom_predictor',
    predict='target_variable',
    select_data_query='SELECT * FROM custom_data',
    training_options={'custom_settings': True}
)
```

### Real-time Integration
```python
# Real-time data processing
def process_realtime_data(self, data_stream):
    # Process incoming data in real-time
    pass
```

## üåü Use Cases

### 1. Climate Research
- Long-term sea level trend analysis
- Climate change impact assessment
- Regional climate pattern identification

### 2. Coastal Management
- Flood risk assessment
- Coastal infrastructure planning
- Emergency response planning

### 3. Marine Operations
- Navigation planning
- Port operations optimization
- Marine safety assessment

### 4. Environmental Monitoring
- Ecosystem impact assessment
- Habitat change detection
- Environmental policy support

## üìû Support

For issues or questions:

1. **Check the logs**: Look for error messages in the console output
2. **Verify data**: Ensure all data files are present and accessible
3. **Test connectivity**: Verify MindsDB server is running
4. **Check dependencies**: Ensure all required packages are installed

## üîÑ Updates and Maintenance

### Regular Updates
- Update MindsDB to latest version
- Refresh satellite data periodically
- Retrain models with new data
- Validate prediction accuracy

### Data Quality
- Monitor data completeness
- Validate data accuracy
- Check for anomalies
- Maintain data documentation

---

**Note**: This integration is designed for research and analysis purposes. For production use, additional error handling, security measures, and performance optimization may be required.
